"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4295],{4295:(N,p,l)=>{l.r(p),l.d(p,{BizumPagePageModule:()=>z});var g=l(6814),m=l(95),i=l(2511),s=l(4258),f=l(3044),c=l(5861),e=l(6689);const h=function(){return{class:"enNaranja",condicion:"row['estadoid'] == 1"}},y=function(){return{class:"enVerde",condicion:"row['estadoid'] == 2"}},v=function(){return{class:"enGris",condicion:"row['estadoid'] == 3"}},C=function(o,u,d){return[o,u,d]},b=[{path:"",component:(()=>{var o;class u extends s.BasePage{constructor(t,n,r,a){super(t,a),this.myHttpService=t,this.utilService=n,this.alertController=r,this.seguridadService=a,this.columns=[],this.NoCerrados=!0,this.entityName="userxbizum"}ngOnInit(){var t=this;return(0,c.Z)(function*(){t.Init(),t.columns=[{name:"De quien",prop:"dequien",type:"text"},{name:"importe",prop:"importe",type:"number"},{name:"P.",prop:"estadoid",type:"action",icon:"swap-horizontal",filterInit:'  ux."estadoid"<>3 ',action:"updatePendiente",OrderInit:"ASC",canAction:t.user.isAdmin},{name:"F",prop:"fecha",type:"date",OrderInit:"ASC"}],t.getTableRefresh()})()}NoCerradosEvent(t){let n=this.columns.find(r=>"estadoid"==r.prop);n&&(n.filterInit=this.NoCerrados?"":' ux."estadoid"<>3',this.getTableRefresh())}actionEmiter(t){var n=this;return(0,c.Z)(function*(){var a;"updatePendiente"===(null==t?void 0:t.action)&&(yield(yield n.alertController.create({header:"Antenci\xf3n!! se va a confirmar el bizum. \xbfContinuar?",buttons:[{text:"Cancelar",role:"cancel",handler:()=>{}},{text:"OK",role:"confirm",handler:(a=(0,c.Z)(function*(){n.updatePendiente(t.row)}),function(){return a.apply(this,arguments)})}]})).present())})()}updatePendiente(t){var n=this;return(0,c.Z)(function*(){try{n.isLoading=!0;const a=new s.classHttp("put",n.entityName,null,"Confirmar",{estadoid:1==t.estadoid?2:1},t.id);(yield n.myHttpService.ejecuteURL(a))&&(n.utilService.message(s.typeMessage.success,"Guardado correctamente"),n.getTableRefresh())}catch{}})()}cerrarEvent(){var t=this;return(0,c.Z)(function*(){var r;yield(yield t.alertController.create({header:`Antenci\xf3n!! se van a cerrar todos los bizum confirmados (${t.TotalImporte} \u20ac). \xbfContinuar?`,buttons:[{text:"Cancelar",role:"cancel",handler:(r=(0,c.Z)(function*(){}),function(){return r.apply(this,arguments)})},{text:"OK",role:"confirm",handler:function(){var r=(0,c.Z)(function*(){yield t.cerrarAll()});return function(){return r.apply(this,arguments)}}()}]})).present()})()}cerrarAll(){var t=this;return(0,c.Z)(function*(){try{const n=new s.classHttp("put",t.entityName,null,"cerrarAll",{});(yield t.myHttpService.ejecuteURL(n))&&(t.utilService.message(s.typeMessage.success,"Guardado correctamente"),t.getTableRefresh())}catch{}})()}onLoadDataEmiter(t){let n=t.filter(r=>2==r.estadoid);n=n.map(r=>r.importe),this.TotalImporte=n.reduce((r,a)=>r+Number(a),0)}}return(o=u).\u0275fac=function(t){return new(t||o)(e.Y36(s.MyHttpService),e.Y36(s.UtilService),e.Y36(i.Br),e.Y36(s.SeguridadService))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-bizum"]],features:[e.qOj],decls:19,vars:18,consts:[[1,"router-outlet"],[3,"enableOnOffLabels","ngModel","ngModelChange","click"],["color","danger",3,"click"],["slot","start","name","star"],["slot","start"],[3,"title","entityName","columns","withCache","refresh","pageSize","objNgClass","isLoading","actionEmiter","onLoadDataEmiter"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-grid",0)(1,"ion-row")(2,"ion-col")(3,"ion-toggle",1),e.NdJ("ngModelChange",function(a){return n.NoCerrados=a})("click",function(a){return n.NoCerradosEvent(a)}),e._uU(4,"No cerrados"),e.qZA()(),e.TgZ(5,"ion-col")(6,"ion-button",2),e.NdJ("click",function(){return n.cerrarEvent()}),e._UZ(7,"ion-icon",3),e._uU(8," CERRAR "),e.qZA()()(),e.TgZ(9,"ion-row")(10,"ion-col")(11,"ion-item")(12,"ion-badge",4),e._uU(13),e.qZA(),e.TgZ(14,"ion-label"),e._uU(15,"Total bizum confirmados"),e.qZA()()()(),e.TgZ(16,"ion-row")(17,"ion-col")(18,"my-table",5),e.NdJ("actionEmiter",function(a){return n.actionEmiter(a)})("onLoadDataEmiter",function(a){return n.onLoadDataEmiter(a)}),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("enableOnOffLabels",!0)("ngModel",n.NoCerrados),e.xp6(10),e.hij(" ",n.TotalImporte," \u20ac"),e.xp6(5),e.Q6J("title","Bizums")("entityName",n.entityName)("columns",n.columns)("withCache",!0)("refresh",n.tableRefresh)("pageSize",5)("objNgClass",e.kEZ(14,C,e.DdM(11,h),e.DdM(12,y),e.DdM(13,v)))("isLoading",n.isLoading))},dependencies:[m.JJ,m.On,i.yp,i.YG,i.wI,i.jY,i.gu,i.Ie,i.Q$,i.Nd,i.ho,i.w,s.MyTableComponent]}),u})()}];let z=(()=>{var o;class u{}return(o=u).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[g.ez,m.u5,m.UX,i.Pc,f.Bz.forChild(b),s.SharedComponentsModule]}),u})()}}]);