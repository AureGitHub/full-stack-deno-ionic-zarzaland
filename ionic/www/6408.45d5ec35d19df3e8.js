"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6408],{6408:(M,m,l)=>{l.r(m),l.d(m,{AgendaPageModule:()=>C});var _=l(177),p=l(4341),a=l(4742),s=l(8464),f=l(1547),b=l(8986),g=l(467),e=l(4438);const v=["editorEntity"],E=()=>[];function j(i,c){if(1&i){const r=e.RV6();e.j41(0,"ion-tab-button",3),e.bIt("click",function(){e.eBV(r);const n=e.XpG();return e.Njj(n.buttonTab("turnos"))}),e.nrm(1,"icon-remixicon"),e.EFF(2," Turnos "),e.k0s()}if(2&i){const r=e.XpG();e.Y8G("selected",r.buttonsTab.turnos),e.R7$(),e.HbH("ri-user-shared-line")}}function T(i,c){if(1&i&&(e.j41(0,"ion-row")(1,"ion-col"),e.nrm(2,"tc-tipos",15),e.k0s()()),2&i){const r=e.XpG();e.R7$(2),e.Y8G("columns",r.columns)("entityName","casa/evento_tipo")("user",r.user)("tableRefresh",r.tableRefresh)}}function y(i,c){if(1&i){const r=e.RV6();e.j41(0,"ion-row",16)(1,"ion-col",8)(2,"ion-grid")(3,"ion-row")(4,"ion-col",17)(5,"ion-checkbox",18),e.mxI("ngModelChange",function(n){e.eBV(r);const o=e.XpG();return e.DH7(o.turnos.carmen,n)||(o.turnos.carmen=n),e.Njj(n)}),e.bIt("ionChange",function(){e.eBV(r);const n=e.XpG();return e.Njj(n.turnos.aure=!n.turnos.carmen)}),e.EFF(6,"Carmen"),e.k0s()(),e.j41(7,"ion-col",19)(8,"ion-checkbox",18),e.mxI("ngModelChange",function(n){e.eBV(r);const o=e.XpG();return e.DH7(o.turnos.aure,n)||(o.turnos.aure=n),e.Njj(n)}),e.bIt("ionChange",function(){e.eBV(r);const n=e.XpG();return e.Njj(n.turnos.carmen=!n.turnos.aure)}),e.EFF(9,"Aure"),e.k0s()()(),e.j41(10,"ion-row")(11,"ion-col",8)(12,"ion-radio-group",20),e.mxI("ngModelChange",function(n){e.eBV(r);const o=e.XpG();return e.DH7(o.tipoturno,n)||(o.tipoturno=n),e.Njj(n)}),e.j41(13,"ion-grid")(14,"ion-row")(15,"ion-col",21)(16,"ion-label"),e.EFF(17,"D\xeda"),e.k0s(),e.nrm(18,"ion-radio",22),e.k0s(),e.j41(19,"ion-col",21)(20,"ion-label"),e.EFF(21,"Semana"),e.k0s(),e.nrm(22,"ion-radio",23),e.k0s(),e.nrm(23,"ion-col",21),e.k0s()()()()()()()()}if(2&i){const r=e.XpG();e.R7$(5),e.R50("ngModel",r.turnos.carmen),e.R7$(3),e.R50("ngModel",r.turnos.aure),e.R7$(4),e.R50("ngModel",r.tipoturno)}}function k(i,c){if(1&i){const r=e.RV6();e.j41(0,"div",24),e.bIt("click",function(){const n=e.eBV(r).$implicit,o=e.XpG();return e.Njj(o.updateEvento(n.id))}),e.j41(1,"span"),e.EFF(2),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()}if(2&i){const r=c.$implicit;e.xc7("background-color",null==r?null:r.color),e.R7$(2),e.JRh(r.descripcion),e.R7$(2),e.JRh(r.observaciones)}}const A=[{path:"",component:(()=>{var i;class c extends s.BasePage{constructor(t){super(t),this.basePageService=t,this.buttonsTab={},this.turnos={},this.columns=[{name:"Descripci\xf3n",prop:"descripcion",type:"text",OrderInit:"ASC"},{name:"Color",prop:"color",type:"text"},{name:"BK Color",prop:"bkcolor",type:"text"}],this.entityName="casa/evento"}ngOnInit(){var t=this;return(0,g.A)(function*(){t.Init(),t.getEventos()})()}handleRefresh(t){var n=this;return(0,g.A)(function*(){n.getEventos(),t.target.complete()})()}getEventos(){var t=this;return(0,g.A)(function*(){t.isLoading=!0;let n=new s.classHttp("get","casa/evento",null,"",null,null);try{let o=yield t.myHttpService.ejecuteURL(n);t.lstEventos=null==o?void 0:o.data,t.lstEventosDia=[]}catch(o){t.utilService.message(s.typeMessage.danger,o.message)}finally{t.isLoading=!1}})()}gestionTurnos(t){var n=this;return(0,g.A)(function*(){if((n.turnos.carmen||n.turnos.aure)&&n.tipoturno){const o={};o.eventotipoid=n.turnos.aure?"2":"3",o.periodoturno=n.tipoturno,o.fecha=n.utilService.toISOString(new Date(t)),n.isLoading=!0,yield n.myHttpService_EXEC.Save("post","casa/evento",o,n.pk),n.getEventos()}})()}refreshSelectedDate(t){var n=this;return(0,g.A)(function*(){if(n.fechaselected=t,n.buttonsTab.turnos)yield n.gestionTurnos(t);else{const P=`${t.getUTCFullYear()}-${t.getMonth()+1<10?`0${t.getMonth()+1}`:t.getMonth()+1}-${t.getDate()<10?`0${t.getDate()}`:t.getDate()}`;n.lstEventosDia=n.lstEventos.filter(h=>h.fecha==P&&![2,3].some(R=>R==h.eventotipoid))}})()}refreshEnvents(t){}buttonTab(t){const n=this.buttonsTab[t];for(const o in this.buttonsTab)this.buttonsTab[o]=!1;n||(this.buttonsTab[t]=!this.buttonsTab.hasOwnProperty(t)||!this.buttonsTab[t])}addEvento(){const t={fecha:this.utilService.toISOString(this.fechaselected)};this.editorEntityComponent.management(0,{entityInitialValues:t})}updateEvento(t){this.editorEntityComponent.management(t,null)}}return(i=c).\u0275fac=function(t){return new(t||i)(e.rXU(s.BasePageService))},i.\u0275cmp=e.VBU({type:i,selectors:[["agenda"]],viewQuery:function(t,n){if(1&t&&e.GBs(v,5),2&t){let o;e.mGM(o=e.lsd())&&(n.editorEntityComponent=o.first)}},features:[e.Vt3],decls:23,vars:19,consts:[["editorEntity",""],["slot","fixed",3,"ionRefresh"],["slot","bottom"],[3,"click","selected"],[3,"selected","click",4,"ngIf"],[1,"router-outlet"],[4,"ngIf"],["class","turno",4,"ngIf"],[1,"col-12"],[3,"saveEvent","deleteEvent","WhoHasPermision","MostrarIconAdd","entityName"],[3,"refreshEnvents","refreshSelectedDate","disabled","lan","eventSource"],[1,"flex_row","contendor-eventos-dia"],["shape","round","size","small",3,"click","color"],["slot","start","name","add-outline"],["class","evento-detalle hand flex_column",3,"background-color","click",4,"ngFor","ngForOf"],[3,"columns","entityName","user","tableRefresh"],[1,"turno"],[1,"col-6",2,"background-color","lightgreen"],[3,"ngModelChange","ionChange","ngModel"],[1,"col-6",2,"background-color","lightblue"],[3,"ngModelChange","ngModel"],[1,"col-4"],["value","d"],["value","s"],[1,"evento-detalle","hand","flex_column",3,"click"]],template:function(t,n){if(1&t){const o=e.RV6();e.j41(0,"ion-refresher",1),e.bIt("ionRefresh",function(d){return e.eBV(o),e.Njj(n.handleRefresh(d))}),e.nrm(1,"ion-refresher-content"),e.k0s(),e.j41(2,"ion-tab-bar",2)(3,"ion-tab-button",3),e.bIt("click",function(){return e.eBV(o),e.Njj(n.buttonTab("tipoeventos"))}),e.nrm(4,"icon-remixicon"),e.EFF(5," Tipo "),e.k0s(),e.DNE(6,j,3,3,"ion-tab-button",4),e.k0s(),e.j41(7,"ion-grid",5),e.DNE(8,T,3,4,"ion-row",6)(9,y,24,3,"ion-row",7),e.j41(10,"ion-row")(11,"ion-col",8)(12,"app-editor-entity",9,0),e.bIt("saveEvent",function(){return e.eBV(o),e.Njj(n.getEventos())})("deleteEvent",function(){return e.eBV(o),e.Njj(n.getEventos())}),e.k0s(),e.j41(14,"my-calendar",10),e.bIt("refreshEnvents",function(d){return e.eBV(o),e.Njj(n.refreshEnvents(d))})("refreshSelectedDate",function(d){return e.eBV(o),e.Njj(n.refreshSelectedDate(d))}),e.k0s()()(),e.j41(15,"ion-row")(16,"ion-col",8)(17,"div",11)(18,"ion-button",12),e.bIt("click",function(){return e.eBV(o),e.Njj(n.addEvento())}),e.nrm(19,"ion-icon",13),e.EFF(20),e.nI1(21,"date"),e.k0s(),e.DNE(22,k,5,4,"div",14),e.k0s()()()()}2&t&&(e.R7$(3),e.Y8G("selected",n.buttonsTab.tipoeventos),e.R7$(),e.HbH("ri-image-add-fill"),e.R7$(2),e.Y8G("ngIf",n.user),e.R7$(2),e.Y8G("ngIf",n.buttonsTab.tipoeventos),e.R7$(),e.Y8G("ngIf",n.buttonsTab.turnos),e.R7$(3),e.Y8G("WhoHasPermision",e.lJ4(18,E))("MostrarIconAdd",!1)("entityName",n.entityName),e.R7$(2),e.Y8G("disabled",n.isLoading)("lan","ES")("eventSource",n.lstEventos),e.R7$(4),e.Y8G("color","success"),e.R7$(2),e.SpI(" ",e.i5U(21,15,n.fechaselected,"dd/MM/yy")," "),e.R7$(2),e.Y8G("ngForOf",n.lstEventosDia))},dependencies:[_.Sq,_.bT,p.BC,p.vS,a.Jm,a.eY,a.hU,a.lO,a.iq,a.he,a.KO,a.f0,a.To,a.Ki,a.ln,a.Jq,a.qW,a.hB,a.Je,s.EditorEntityComponent,s.Tc_tipoComponent,s.CalendarComponent,s.IconremixiconComponent,_.vh],styles:[".turno[_ngcontent-%COMP%]{font-size:12px;background-color:#d3d3d3}.contendor-eventos-dia[_ngcontent-%COMP%]{column-gap:10px}.evento-detalle[_ngcontent-%COMP%]{border:solid 1px;border-radius:5px;padding:5px}"]}),c})()}];let C=(()=>{var i;class c{}return(i=c).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[_.MD,p.YN,p.X1,a.bv,b.iI.forChild(A),s.SharedComponentsModule,f.bG,s.CalendarComponentModule,s.IconremixiconComponentModule]}),c})()}}]);