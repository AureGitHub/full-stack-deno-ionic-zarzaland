"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6171],{6171:(w,P,a)=>{a.r(P),a.d(P,{CompraPageModule:()=>j});var g=a(177),h=a(4341),l=a(8974),c=a(8464),v=a(1547),_=a(8986),u=a(467),t=a(4438);function C(r,n){if(1&r){const i=t.RV6();t.j41(0,"ion-row")(1,"ion-col")(2,"tc-tipos",12),t.bIt("deleteEvent",function(e){t.eBV(i);const s=t.XpG();return t.Njj(s.deleteEventProducto(e))})("saveEvent",function(e){t.eBV(i);const s=t.XpG();return t.Njj(s.saveEventProducto(e))}),t.k0s()()()}if(2&r){const i=t.XpG();t.R7$(2),t.Y8G("entityName","casa/compra_producto")("user",i.user)("tableRefresh",i.tableRefresh)}}function S(r,n){1&r&&t.nrm(0,"app-base-cargando",13),2&r&&t.Y8G("message","Cargando Productos...")}function y(r,n){if(1&r){const i=t.RV6();t.j41(0,"div",14),t.bIt("click",function(){const e=t.eBV(i).$implicit,s=t.XpG();return t.Njj(s.selectProducto(e))}),t.EFF(1),t.k0s()}if(2&r){const i=n.$implicit;t.R7$(),t.SpI(" ",i.descripcion,"")}}function b(r,n){if(1&r){const i=t.RV6();t.j41(0,"div",14),t.bIt("click",function(){const e=t.eBV(i).$implicit,s=t.XpG();return t.Njj(s.unselectProducto(e))}),t.EFF(1),t.k0s()}if(2&r){const i=n.$implicit;t.R7$(),t.SpI(" ",i.descripcion,"")}}const x=[{path:"",component:(()=>{var r;class n extends c.BasePage{constructor(o,e,s,d){super(o,e,s),this.myHttpService=o,this.seguridadService=e,this.myHttpService_EXEC=s,this.utilService=d,this.addProducto=!1,this.lstProductosSelected=[],this.entityName="casa/compra"}ngOnInit(){var o=this;return(0,u.A)(function*(){o.Init(),yield o.getProductos()})()}getProductos(){var o=this;return(0,u.A)(function*(){try{var e,s;o.lstProductos=[],o.isLoading=!0;let f=new c.classHttp("get","casa/compra_producto",null),m=yield o.myHttpService.ejecuteURL(f);var d,p;null!==(e=m)&&void 0!==e&&e.data&&(o.lstProductos=null===(d=m)||void 0===d?void 0:d.data),f=new c.classHttp("get","casa/compra_producto_selected",null),m=yield o.myHttpService.ejecuteURL(f),null!==(s=m)&&void 0!==s&&s.data&&(o.lstProductosSelected=null===(p=m)||void 0===p?void 0:p.data),o.lstProductos=o.lstProductos.filter(E=>!o.lstProductosSelected.some(R=>R.id==E.id))}catch{}finally{o.isLoading=!1}})()}selectProducto(o){var e=this;return(0,u.A)(function*(){const s=o.id;(yield e.myHttpService_EXEC.Save("post","casa/compra_producto_selected",{id:s},e.pk))?(e.lstProductos=e.lstProductos.filter(p=>p.id!=o.id),e.lstProductosSelected.push(o),e.lstProductosSelected=e.lstProductosSelected.sort(e.compare)):e.utilService.message(c.typeMessage.danger,"No se ha podido a\xf1adir el producto")})()}unselectProducto(o){var e=this;return(0,u.A)(function*(){const s=o.id;(yield e.myHttpService_EXEC.Save("delete","casa/compra_producto_selected",{compra_productoid:s},"compra_productoid"))?(e.lstProductosSelected=e.lstProductosSelected.filter(p=>p.id!=o.id),e.lstProductos.push(o),e.lstProductos=e.lstProductos.sort(e.compare)):e.utilService.message(c.typeMessage.danger,"No se ha podido borrar el producto")})()}compare(o,e){return o.descripcion<e.descripcion?-1:o.descripcion>e.descripcion?1:0}handleRefresh(o){var e=this;return(0,u.A)(function*(){yield e.getProductos(),o.target.complete()})()}saveEventProducto(o){this.lstProductosSelected.some(e=>e.id==o.id)?(this.lstProductosSelected=this.lstProductosSelected.filter(e=>e.id!=o.id),this.lstProductosSelected.push(o),this.lstProductosSelected=this.lstProductosSelected.sort(this.compare)):(this.lstProductos=this.lstProductos.filter(e=>e.id!=o.id),this.lstProductos.push(o),this.lstProductos=this.lstProductos.sort(this.compare))}deleteEventProducto(o){this.lstProductos=this.lstProductos.filter(e=>e.id!=o.id)}}return(r=n).\u0275fac=function(o){return new(o||r)(t.rXU(c.MyHttpService),t.rXU(c.SeguridadService),t.rXU(c.MyHttpService_EXEC),t.rXU(c.UtilService))},r.\u0275cmp=t.VBU({type:r,selectors:[["bolsa"]],features:[t.Vt3],decls:16,vars:5,consts:[["slot","fixed",3,"ionRefresh"],[1,"router-outlet"],[1,"col-2"],["shape","round","size","small",3,"click","color"],["slot","start","name","fast-food-outline"],[1,"col-3"],[1,"col-7"],[4,"ngIf"],[3,"message",4,"ngIf"],[1,"container-producto"],["class","item hand",3,"click",4,"ngFor","ngForOf"],[1,"container-selected"],[3,"deleteEvent","saveEvent","entityName","user","tableRefresh"],[3,"message"],[1,"item","hand",3,"click"]],template:function(o,e){1&o&&(t.j41(0,"ion-refresher",0),t.bIt("ionRefresh",function(d){return e.handleRefresh(d)}),t.nrm(1,"ion-refresher-content"),t.k0s(),t.j41(2,"ion-grid",1)(3,"ion-row")(4,"ion-col",2)(5,"ion-button",3),t.bIt("click",function(){return e.addProducto=!e.addProducto}),t.nrm(6,"ion-icon",4),t.k0s()(),t.nrm(7,"ion-col",5)(8,"ion-col",6),t.k0s(),t.DNE(9,C,3,3,"ion-row",7),t.j41(10,"ion-row"),t.DNE(11,S,1,1,"app-base-cargando",8),t.j41(12,"div",9),t.DNE(13,y,2,1,"div",10),t.k0s(),t.j41(14,"div",11),t.DNE(15,b,2,1,"div",10),t.k0s()()()),2&o&&(t.R7$(5),t.Y8G("color",e.addProducto?"warning":"success"),t.R7$(4),t.Y8G("ngIf",e.addProducto),t.R7$(2),t.Y8G("ngIf",e.isLoading),t.R7$(2),t.Y8G("ngForOf",e.lstProductos),t.R7$(2),t.Y8G("ngForOf",e.lstProductosSelected))},dependencies:[g.Sq,g.bT,l.Jm,l.hU,l.lO,l.iq,l.To,l.Ki,l.ln,c.CargandoComponent,c.Tc_tipoComponent],styles:[".container-producto[_ngcontent-%COMP%]{background-color:#a4a4a4;border-radius:25px;box-shadow:5px 10px;border:1px solid #585858;padding:10px;display:flex;justify-content:center;align-items:center;flex-wrap:wrap;width:50%;align-content:space-between}.container-selected[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center;flex-flow:row wrap;align-content:space-between;border-radius:25px;box-shadow:5px 10px;border:1px solid #585858;background-color:#ffffe0;padding:10px;width:50%;height:100%;min-height:50px}.item[_ngcontent-%COMP%]{width:100px;background:#fff;border:1px solid black;font-size:14px;text-align:center;vertical-align:middle;margin-left:5px;margin-bottom:5px;min-height:20px}"]}),n})()}];let j=(()=>{var r;class n{}return(r=n).\u0275fac=function(o){return new(o||r)},r.\u0275mod=t.$C({type:r}),r.\u0275inj=t.G2t({imports:[g.MD,h.YN,h.X1,l.bv,_.iI.forChild(x),c.SharedComponentsModule,v.bG]}),n})()}}]);