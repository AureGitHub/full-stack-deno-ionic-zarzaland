"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6408],{6408:(P,m,l)=>{l.r(m),l.d(m,{AgendaPageModule:()=>C});var _=l(177),p=l(4341),a=l(4742),s=l(8464),f=l(1547),v=l(8986),g=l(467),e=l(4438);const b=["editorEntity"];function E(i,d){if(1&i&&(e.j41(0,"ion-row")(1,"ion-col"),e.nrm(2,"tc-tipos",14),e.k0s()()),2&i){const r=e.XpG();e.R7$(2),e.Y8G("columns",r.columns)("entityName","casa/evento_tipo")("user",r.user)("tableRefresh",r.tableRefresh)}}function j(i,d){if(1&i){const r=e.RV6();e.j41(0,"ion-row",15)(1,"ion-col",7)(2,"ion-grid")(3,"ion-row")(4,"ion-col",16)(5,"ion-checkbox",17),e.mxI("ngModelChange",function(n){e.eBV(r);const o=e.XpG();return e.DH7(o.turnos.carmen,n)||(o.turnos.carmen=n),e.Njj(n)}),e.bIt("ionChange",function(){e.eBV(r);const n=e.XpG();return e.Njj(n.turnos.aure=!n.turnos.carmen)}),e.EFF(6,"Carmen"),e.k0s()(),e.j41(7,"ion-col",18)(8,"ion-checkbox",17),e.mxI("ngModelChange",function(n){e.eBV(r);const o=e.XpG();return e.DH7(o.turnos.aure,n)||(o.turnos.aure=n),e.Njj(n)}),e.bIt("ionChange",function(){e.eBV(r);const n=e.XpG();return e.Njj(n.turnos.carmen=!n.turnos.aure)}),e.EFF(9,"Aure"),e.k0s()()(),e.j41(10,"ion-row")(11,"ion-col",7)(12,"ion-radio-group",19),e.mxI("ngModelChange",function(n){e.eBV(r);const o=e.XpG();return e.DH7(o.tipoturno,n)||(o.tipoturno=n),e.Njj(n)}),e.j41(13,"ion-grid")(14,"ion-row")(15,"ion-col",20)(16,"ion-label"),e.EFF(17,"D\xeda"),e.k0s(),e.nrm(18,"ion-radio",21),e.k0s(),e.j41(19,"ion-col",20)(20,"ion-label"),e.EFF(21,"Semana"),e.k0s(),e.nrm(22,"ion-radio",22),e.k0s(),e.nrm(23,"ion-col",20),e.k0s()()()()()()()()}if(2&i){const r=e.XpG();e.R7$(5),e.R50("ngModel",r.turnos.carmen),e.R7$(3),e.R50("ngModel",r.turnos.aure),e.R7$(4),e.R50("ngModel",r.tipoturno)}}function T(i,d){if(1&i){const r=e.RV6();e.j41(0,"div",23),e.bIt("click",function(){const n=e.eBV(r).$implicit,o=e.XpG();return e.Njj(o.updateEvento(n.id))}),e.j41(1,"span"),e.EFF(2),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()}if(2&i){const r=d.$implicit;e.xc7("background-color",null==r?null:r.color),e.R7$(2),e.JRh(r.descripcion),e.R7$(2),e.JRh(r.observaciones)}}const y=[{path:"",component:(()=>{var i;class d extends s.BasePage{constructor(t){super(t),this.basePageService=t,this.buttonsTab={},this.turnos={},this.columns=[{name:"Descripci\xf3n",prop:"descripcion",type:"text",OrderInit:"ASC"},{name:"Color",prop:"color",type:"text"},{name:"BK Color",prop:"bkcolor",type:"text"}],this.entityName="casa/evento"}ngOnInit(){var t=this;return(0,g.A)(function*(){t.Init(),t.getEventos()})()}handleRefresh(t){var n=this;return(0,g.A)(function*(){n.getEventos(),t.target.complete()})()}getEventos(){var t=this;return(0,g.A)(function*(){t.isLoading=!0;let n=new s.classHttp("get","casa/evento",null,"",null,null);try{let o=yield t.myHttpService.ejecuteURL(n);t.lstEventos=null==o?void 0:o.data,t.lstEventosDia=[]}catch(o){t.utilService.message(s.typeMessage.danger,o.message)}finally{t.isLoading=!1}})()}gestionTurnos(t){var n=this;return(0,g.A)(function*(){if((n.turnos.carmen||n.turnos.aure)&&n.tipoturno){const o={};o.eventotipoid=n.turnos.aure?"2":"3",o.periodoturno=n.tipoturno,o.fecha=n.utilService.toISOString(new Date(t)),n.isLoading=!0,yield n.myHttpService_EXEC.Save("post","casa/evento",o,n.pk),n.getEventos()}})()}refreshSelectedDate(t){var n=this;return(0,g.A)(function*(){if(n.fechaselected=t,n.buttonsTab.turnos)yield n.gestionTurnos(t);else{const k=`${t.getUTCFullYear()}-${t.getMonth()+1<10?`0${t.getMonth()+1}`:t.getMonth()+1}-${t.getDate()<10?`0${t.getDate()}`:t.getDate()}`;n.lstEventosDia=n.lstEventos.filter(h=>h.fecha==k&&![2,3].some(A=>A==h.eventotipoid))}})()}refreshEnvents(t){}buttonTab(t){const n=this.buttonsTab[t];for(const o in this.buttonsTab)this.buttonsTab[o]=!1;n||(this.buttonsTab[t]=!this.buttonsTab.hasOwnProperty(t)||!this.buttonsTab[t])}addEvento(){const t={fecha:this.utilService.toISOString(this.fechaselected)};this.editorEntityComponent.management(0,{entityInitialValues:t})}updateEvento(t){this.editorEntityComponent.management(t,null)}}return(i=d).\u0275fac=function(t){return new(t||i)(e.rXU(s.BasePageService))},i.\u0275cmp=e.VBU({type:i,selectors:[["agenda"]],viewQuery:function(t,n){if(1&t&&e.GBs(b,5),2&t){let o;e.mGM(o=e.lsd())&&(n.editorEntityComponent=o.first)}},features:[e.Vt3],decls:25,vars:19,consts:[["editorEntity",""],["slot","fixed",3,"ionRefresh"],["slot","bottom"],[3,"click","selected"],[1,"router-outlet"],[4,"ngIf"],["class","turno",4,"ngIf"],[1,"col-12"],[3,"saveEvent","deleteEvent","MostrarIconAdd","entityName"],[3,"refreshEnvents","refreshSelectedDate","disabled","lan","eventSource"],[1,"flex_row","contendor-eventos-dia"],["shape","round","size","small",3,"click","color"],["slot","start","name","add-outline"],["class","evento-detalle hand flex_column",3,"background-color","click",4,"ngFor","ngForOf"],[3,"columns","entityName","user","tableRefresh"],[1,"turno"],[1,"col-6",2,"background-color","lightgreen"],[3,"ngModelChange","ionChange","ngModel"],[1,"col-6",2,"background-color","lightblue"],[3,"ngModelChange","ngModel"],[1,"col-4"],["value","d"],["value","s"],[1,"evento-detalle","hand","flex_column",3,"click"]],template:function(t,n){if(1&t){const o=e.RV6();e.j41(0,"ion-refresher",1),e.bIt("ionRefresh",function(u){return e.eBV(o),e.Njj(n.handleRefresh(u))}),e.nrm(1,"ion-refresher-content"),e.k0s(),e.j41(2,"ion-tab-bar",2)(3,"ion-tab-button",3),e.bIt("click",function(){return e.eBV(o),e.Njj(n.buttonTab("tipoeventos"))}),e.nrm(4,"icon-remixicon"),e.EFF(5," Tipo "),e.k0s(),e.j41(6,"ion-tab-button",3),e.bIt("click",function(){return e.eBV(o),e.Njj(n.buttonTab("turnos"))}),e.nrm(7,"icon-remixicon"),e.EFF(8," Turnos "),e.k0s()(),e.j41(9,"ion-grid",4),e.DNE(10,E,3,4,"ion-row",5)(11,j,24,3,"ion-row",6),e.j41(12,"ion-row")(13,"ion-col",7)(14,"app-editor-entity",8,0),e.bIt("saveEvent",function(){return e.eBV(o),e.Njj(n.getEventos())})("deleteEvent",function(){return e.eBV(o),e.Njj(n.getEventos())}),e.k0s(),e.j41(16,"my-calendar",9),e.bIt("refreshEnvents",function(u){return e.eBV(o),e.Njj(n.refreshEnvents(u))})("refreshSelectedDate",function(u){return e.eBV(o),e.Njj(n.refreshSelectedDate(u))}),e.k0s()()(),e.j41(17,"ion-row")(18,"ion-col",7)(19,"div",10)(20,"ion-button",11),e.bIt("click",function(){return e.eBV(o),e.Njj(n.addEvento())}),e.nrm(21,"ion-icon",12),e.EFF(22),e.nI1(23,"date"),e.k0s(),e.DNE(24,T,5,4,"div",13),e.k0s()()()()}2&t&&(e.R7$(3),e.Y8G("selected",n.buttonsTab.tipoeventos),e.R7$(),e.HbH("ri-image-add-fill"),e.R7$(2),e.Y8G("selected",n.buttonsTab.turnos),e.R7$(),e.HbH("ri-user-shared-line"),e.R7$(3),e.Y8G("ngIf",n.buttonsTab.tipoeventos),e.R7$(),e.Y8G("ngIf",n.buttonsTab.turnos),e.R7$(3),e.Y8G("MostrarIconAdd",!1)("entityName",n.entityName),e.R7$(2),e.Y8G("disabled",n.isLoading)("lan","ES")("eventSource",n.lstEventos),e.R7$(4),e.Y8G("color","success"),e.R7$(2),e.SpI(" ",e.i5U(23,16,n.fechaselected,"dd/MM/yy")," "),e.R7$(2),e.Y8G("ngForOf",n.lstEventosDia))},dependencies:[_.Sq,_.bT,p.BC,p.vS,a.Jm,a.eY,a.hU,a.lO,a.iq,a.he,a.KO,a.f0,a.To,a.Ki,a.ln,a.Jq,a.qW,a.hB,a.Je,s.EditorEntityComponent,s.Tc_tipoComponent,s.CalendarComponent,s.IconremixiconComponent,_.vh],styles:[".turno[_ngcontent-%COMP%]{font-size:12px;background-color:#d3d3d3}.contendor-eventos-dia[_ngcontent-%COMP%]{column-gap:10px}.evento-detalle[_ngcontent-%COMP%]{border:solid 1px;border-radius:5px;padding:5px}"]}),d})()}];let C=(()=>{var i;class d{}return(i=d).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[_.MD,p.YN,p.X1,a.bv,v.iI.forChild(y),s.SharedComponentsModule,f.bG,s.CalendarComponentModule,s.IconremixiconComponentModule]}),d})()}}]);